import os
import hashlib

#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#

def Scan_Size(mSize_db, inputFile) :
    inputSize = os.path.getsize(inputFile)

    if mSize_db.count(inputSize) :
        return True
    
    return False

def Scan_MD5(m_db, inputBuf) :
    md5 = hashlib.md5()
    md5.update(inputBuf)
    fMD5 = md5.hexdigest()

    for temp in m_db :
        if fMD5 == temp[0] :
            print("( + ) Detected By MD5")
            return True, temp[1]
    
    return False, ''

#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#

def Scan_Malware(mSize_db, m_db, inputFile) :
    result = False
    mName = ''

    result_scanSize = Scan_Size(mSize_db, inputFile)
    if result_scanSize == True :
        fHandle = open(inputFile, 'rb')
        fBuf = fHandle.read()
        fHandle.close()

        # Malware Scan 1. MD5
        result, mName = Scan_MD5(m_db, fBuf)
        if result == True :
            return result, mName
        
        # Malware Scan 2. (?)
        
    return result, mName
