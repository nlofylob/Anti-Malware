import os
import hashlib

#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#
M_MD5 = '44d88612fea8a8f36de82e1278abb02f'
M_SIGNATURE = b'X5O'

EICAR = "../../Sample/eicar.txt"
REMOVE = "../../Sample/remove"
#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#

fileP = open(EICAR, 'rb')
fileBuf = fileP.read()
fileP.close()

# MD5
md5 = hashlib.md5()
md5.update(fileBuf)
fileMD5 = md5.hexdigest()

if fileMD5 == M_MD5 :
    print("Malware - Detected By MD5")
    print(f'Malware MD5 : ${fileMD5}')
    #os.remove(REMOVE)
else :
    print("Not Malware")
    print(f'File (Not Malware) MD5 : ${fileMD5}')

# Signature
fileSignature = fileBuf[0:3]

if fileSignature == M_SIGNATURE :
    print("Malware - Detected By Signature")
    print(f'Malware Signature : ${fileSignature}')
    #os.remove(REMOVE)
else :
    print("Not Malware")
    print(f'File (Not Malware) Signature : ${fileSignature}')

#print(fileBuf)