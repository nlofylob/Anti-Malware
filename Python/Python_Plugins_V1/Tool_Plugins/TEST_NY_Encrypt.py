import sys
import marshal

import Python_Plugins_V1.Tool_Plugins.NY_Encrypt as NY_Encrypt
import Python_Plugins_V1.Tool_Plugins.NY_Encrypt_RSA as NY_Encrypt_RSA

# Dynamic
import test

TOOL_PATH = 'Python_Plugins_V1/Tool_Plugins/'
MALWARE_PATH = 'Python_Plugins_V1/Malware_Plugins/'

NY_Encrypt_RSA.create_key(TOOL_PATH + 'key.public', TOOL_PATH + 'key.private')

# Path : Tool_Plugins
ny_nyam = NY_Encrypt.createNY(TOOL_PATH + 'NYAM.list')

# Path : Malware_Plugins
ny_library_Hash = NY_Encrypt.createNY(MALWARE_PATH + 'library_Hash.py')
ny_test = NY_Encrypt.createNY(MALWARE_PATH + 'test.py')
ny_eicar = NY_Encrypt.createNY(MALWARE_PATH + 'eicar.py')

if (ny_library_Hash and ny_nyam and ny_test and ny_eicar) :
    public_key = NY_Encrypt_RSA.read_key(TOOL_PATH + 'key.public')

    # Path : Tool_Plugins
    file_nyam = NY_Encrypt.NY(TOOL_PATH + 'NYAM.ny', public_key)

    # Path : Malware_Plugins
    file_library_Hash = NY_Encrypt.NY(MALWARE_PATH + 'library_Hash.ny', public_key)
    file_test = NY_Encrypt.NY(MALWARE_PATH + 'test.ny', public_key)
    file_eicar = NY_Encrypt.NY(MALWARE_PATH + 'eicar.ny', public_key)

    print()
    print("[ NYAM ]")
    print("#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#")
    print(file_nyam.body)
    print("#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#")
    print()

    print()
    print("[ library_Hash ]")
    print("#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#")
    print(file_library_Hash.body)
    print("#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#")
    print()
    print("[ test ]")
    print("#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#")
    print(file_test.body)
    print("#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#")
    print()
    print("[ eicar ]")
    print("#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#")
    print(file_eicar.body)
    print("#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#")
    print()

    """
    module = NY_Encrypt.load('test', file.body)
    if module == None :
        print("%%%%%%%% ERROR %%%%%%%%")
    else :
        print()
        print("#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#")
        print(dir(module))
        print("#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#")
        print()
    
    moduleHandle = test.NYamMain()
    moduleHandle.init('.')
    print(moduleHandle.getMalwareList())
    print(moduleHandle.getModuleInformation())
    moduleHandle.uninit()
    """