import sys
import marshal

import NY_Encrypt_RSA
import NY_Encrypt

# Dynamic
import test

NY_Encrypt_RSA.create_key('key.public', 'key.private')

ny_nyam = NY_Encrypt.createNY('NYAM.list')
ny_test = NY_Encrypt.createNY('test.py')
ny_eicar = NY_Encrypt.createNY('eicar.py')

if (ny_nyam and ny_test and ny_eicar) :
    public_key = NY_Encrypt_RSA.read_key('key.public')

    file_nyam = NY_Encrypt.NY('NYAM.ny', public_key)
    file_test = NY_Encrypt.NY('test.ny', public_key)
    file_eicar = NY_Encrypt.NY('eicar.ny', public_key)
    print("[ NYAM ]")
    print("#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#")
    print(file_nyam.body)
    print("#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#")
    print()
    print("[ test ]")
    print("#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#")
    print(file_test.body)
    print("#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#")
    print()
    print("[ eicar ]")
    print("#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#")
    print(file_eicar.body)
    print("#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#")
    print()

    """
    module = NY_Encrypt.load('test', file.body)
    if module == None :
        print("%%%%%%%% ERROR %%%%%%%%")
    else :
        print()
        print("#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#")
        print(dir(module))
        print("#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#")
        print()
    
    moduleHandle = test.NYamMain()
    moduleHandle.init('.')
    print(moduleHandle.getMalwareList())
    print(moduleHandle.getModuleInformation())
    moduleHandle.uninit()
    """