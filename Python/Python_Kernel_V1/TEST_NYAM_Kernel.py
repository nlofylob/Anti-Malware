import Python_Kernel_V1.NYAM_Kernel as NYAM_Kernel

TARGET_PATH = '../Sample/test.txt'

#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#

def malware_list_callback(plugin_name, malware_list) :
    print(f"    ( + ) Malware List - {plugin_name}")
    for malware_name in malware_list :
        print(f"        ( - ) {malware_name}")

#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#

ny = NYAM_Kernel.Kernel(debug = True)
if ny.set_plugins('./Python_Plugins_V1/Tool_Plugins') :
    instance = ny.create_instance()

    if instance :
        print()
        print("#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#")
        print("[ SUCCESS ] Create Plugin's Instance of NYamMain")
        print("#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#=#")
        print()

        result = instance.init()

        information = instance.get_information()

        print("( Check ) =>=>=>=> Not With a Callback Function")
        malware_list = instance.get_malware_list()
        print("( Check ) =>=>=>=> With a Callback Function")
        malware_list = instance.get_malware_list(malware_list_callback)

        result, malware_name, malware_id, plugin_id = instance.scan(TARGET_PATH)
        
        if result :
            instance.clean(TARGET_PATH, malware_id, plugin_id)

        instance.uninit()
    
    else :
        print("%%%% FAIL %%%%")
